/**
 * @license tm-urban-contest v1.0.0
 * (c) 2021 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxcomp-form"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define(["rxcomp","rxcomp-form","rxjs/operators","rxjs"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rxcomp,t.rxcomp.form,t.rxjs.operators,t.rxjs)}(this,(function(t,e,n,r){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var l=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onInit=function(){t.getContext(this).node.classList.remove("hidden")},n}(t.Component);l.meta={selector:"[app-component]"};var c=1e6,u=function(e){function r(){return e.apply(this,arguments)||this}a(r,e);var o=r.prototype;return o.onInit=function(){var e=this,o=t.getContext(this).node,i=o.getAttribute("dropdown-trigger");this.trigger=i?o.querySelector(i):o,this.opened=null,this.onClick=this.onClick.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.openDropdown=this.openDropdown.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this.addListeners(),r.dropdown$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?o.classList.add("dropped"):o.classList.remove("dropped")}))},o.onClick=function(e){var n=t.getContext(this).node;null===this.opened?this.openDropdown():n.querySelector("[dropdown-item]")||this.closeDropdown()},o.onDocumentClick=function(e){var n=t.getContext(this).node;n===e.target||n.contains(e.target)||this.closeDropdown()},o.openDropdown=function(){null===this.opened&&(this.opened=!0,this.addDocumentListeners(),r.dropdown$.next(this.id),this.dropped.next(this.id))},o.closeDropdown=function(){null!==this.opened&&(this.removeDocumentListeners(),this.opened=null,r.dropdown$.getValue()===this.id&&(r.dropdown$.next(null),this.dropped.next(null)))},o.addListeners=function(){this.trigger.addEventListener("click",this.onClick)},o.addDocumentListeners=function(){document.addEventListener("click",this.onDocumentClick)},o.removeListeners=function(){this.trigger.removeEventListener("click",this.onClick)},o.removeDocumentListeners=function(){document.removeEventListener("click",this.onDocumentClick)},o.onDestroy=function(){this.removeListeners(),this.removeDocumentListeners()},r.nextId=function(){return c++},i(r,[{key:"id",get:function(){return this.dropdown||this.id_||(this.id_=r.nextId())}}]),r}(t.Directive);u.meta={selector:"[dropdown]",inputs:["dropdown","dropdown-trigger"],outputs:["dropped"]},u.dropdown$=new r.BehaviorSubject(null);var d=function(e){function r(){return e.apply(this,arguments)||this}return a(r,e),r.prototype.onInit=function(){var e=this,r=t.getContext(this).node;r.classList.add("dropdown-item"),u.dropdown$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?r.classList.add("dropped"):r.classList.remove("dropped")}))},i(r,[{key:"id",get:function(){return this["dropdown-item"]}}]),r}(t.Directive);d.meta={selector:"[dropdown-item], [[dropdown-item]]",inputs:["dropdown-item"]};var p=function(){function t(){}return t.merge=function(t,e){var n=this;return"object"==typeof e&&Object.keys(e).forEach((function(r){var o=e[r];"object"!=typeof o||Array.isArray(o)?t[r]=o:t[r]=n.merge(t[r],o)})),t},t}(),h="undefined"!=typeof module&&module.exports,m=((h?{get:function(){}}:new URLSearchParams(window.location.search)).get("debug"),h?null:document.querySelector("base").getAttribute("href")),f=!h&&(window&&-1!==window.location.host.indexOf("herokuapp")),g=!h&&(f||window&&("48481"===window.location.port||"5000"===window.location.port||"6443"===window.location.port||"actarian.github.io"===window.location.host)),v=!h&&(window&&-1!==["localhost","127.0.0.1","0.0.0.0"].indexOf(window.location.host.split(":")[0])),b={STATIC:g,DEVELOPMENT:v,PRODUCTION:!v},y=function(){var t=e.prototype;function e(t){t&&Object.assign(this,t)}return t.getAbsoluteUrl=function(t,e){var n=""+window.location.origin+t;return Object.keys(e).forEach((function(t){n=n.replace("$"+t,e[t])})),n},t.getPath=function(t){return this.isLocal(t)?this.href+t:t},t.isLocal=function(t){return-1===t.indexOf("://")},i(e,[{key:"STATIC",get:function(){return b.STATIC},set:function(t){b.STATIC=!0===t||"true"===t,console.log("Environment.STATIC.set",b.STATIC)}},{key:"href",get:function(){return f?this.githubDocs:m}}]),e}(),w={port:5e3,flags:{production:!1,heroku:f},slug:{},markets:["IT","EU","AM","AS","IN"],defaultMarket:"IT",currentMarket:"IT",languages:["it","en"],defaultLanguage:"it",currentLanguage:"it",labels:{select:"Seleziona",browse:"Sfoglia",cancel:"Annulla",error_email:"Email non valida",error_match:"I campi non corrispondono",error_required:"Campo obbligatorio",loading:"caricamento",remove:"Rimuovi",required:"Richiesto",select_file:"Seleziona il file",update:"Aggiorna",upload:"Carica",drag_and_drop_images:"Drag And Drop your images here"}},k=window.STATIC?{flags:{production:!1},markets:["IT","EU","AM","AS","IN"],defaultMarket:"IT",currentMarket:"IT",languages:["it","en","de","ch"],defaultLanguage:"it",currentLanguage:"it",api:"/giorgetti/api",assets:"/giorgetti/",workers:{image:"./js/workers/image.service.worker.js",prefetch:"./js/workers/prefetch.service.worker.js"},githubDocs:"https://raw.githubusercontent.com/actarian/giorgetti/main/docs/",slug:{configureProduct:"/giorgetti/products-configure.html",reservedArea:"/giorgetti/reserved-area.html"},template:{modal:{userModal:"/giorgetti/user-modal.html",projectsRegistrationModal:"/giorgetti/projects-registration-modal.html",materialsModal:"/giorgetti/materials-modal.html",marketsAndLanguagesModal:"/giorgetti/markets-and-languages-modal.html"}},googleMaps:{apiKey:"AIzaSyAIsa4g8z-HPPwohsf8jzVTbKw-DiI8k5w"},thron:{clientId:""}}:{flags:{production:!0},markets:["IT","EU","AM","AS","IN"],defaultMarket:"IT",currentMarket:"IT",languages:["it","en","de","ch"],defaultLanguage:"it",currentLanguage:"it",api:"/Client/docs/api",assets:"/Client/docs/",workers:{image:"/Client/docs/js/workers/image.service.worker.js",prefetch:"/Client/docs/js/workers/prefetch.service.worker.js"},githubDocs:"https://raw.githubusercontent.com/actarian/giorgetti/main/docs/",slug:{configureProduct:"/Client/docs/products-configure.html",reservedArea:"/Client/docs/reserved-area.html"},template:{modal:{userModal:"/template/modals/user-modal.cshtml",projectsRegistrationModal:"/template/modals/projects-registration-modal.cshtml",materialsModal:"/template/modals/materials-modal.cshtml",marketsAndLanguagesModal:"/template/modals/markets-and-languages-modal.html"}},googleMaps:{apiKey:"AIzaSyDvGw6iAoKdRv8mmaC9GeT-LWLPQtA8p60"},thron:{clientId:""}},C=Object.assign(w,k),x=new y(C=p.merge(C,window.environment));console.log("environment",x);var L=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){for(var e=x,n=t.split("."),r=n.shift();n.length>0&&e[r];)e=e[r],r=n.shift();return e[r]||null},e}(t.Pipe);L.meta={name:"env"};var T=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){return x.flags[t]||!1},e}(t.Pipe);T.meta={name:"flag"};var M=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){if(t){t=t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e))}));var e=['"',"&","'","<",">"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","­","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","&","•","°","∞","‰","⋅","±","†","—","¬","µ","⊥","∥","€","£","¥","¢","©","®","™","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],n=new RegExp("(&"+["quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","amp","bull","deg","infin","permil","sdot","plusmn","dagger","mdash","not","micro","perp","par","euro","pound","yen","cent","copy","reg","trade","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigma","tau","upsilon","phi","chi","psi","omega","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"].join(";)|(&")+";)","g");return t=t.replace(n,(function(){for(var t=1;t<arguments.length;t++)if(arguments[t])return e[t-1]}))}},e}(t.Pipe);M.meta={name:"html"};var A=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(){t.getContext(this).node.setAttribute("id",this.id)},n}(t.Directive);A.meta={selector:"[id]",inputs:["id"]};var D=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(){t.getContext(this).node.setAttribute("for",this.labelFor)},n}(t.Directive);D.meta={selector:"[labelFor]",inputs:["labelFor"]};var S=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){return e.labels_[t]||t},e.getKeys=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.transform(n.map((function(t){return t.replace("-","_")})).join("_"))},e.setLabels=function(){var t=p.merge({select:"Seleziona",browse:"Sfoglia",cancel:"Annulla",error_email:"Email non valida",error_match:"I campi non corrispondono",error_required:"Campo obbligatorio",loading:"caricamento",remove:"Rimuovi",required:"Richiesto",select_file:"Seleziona il file",update:"Aggiorna",upload:"Carica",drag_and_drop_images:"Drag And Drop your images here"},x.labels);this.labels_=t},e}(t.Pipe);S.setLabels(),S.meta={name:"label"};var $=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),i(n,[{key:"title",set:function(e){if(this.title_!==e){this.title_=e;var n=t.getContext(this).node;e?n.setAttribute("title",e):n.removeAttribute("title")}},get:function(){return this.title_}}]),n}(t.Directive);$.meta={selector:"[[title]]",inputs:["title"]};var E=[u,d,A,D,$],_=[L,T,M,S],q=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e}(t.Module);q.meta={imports:[],declarations:[].concat(E,_),exports:[].concat(E,_)};var I=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(){var e=t.getContext(this).node,n=this.control.flags;Object.keys(n).forEach((function(t){n[t]?e.classList.add(t):e.classList.remove(t)}))},n}(t.Component);I.meta={selector:"[control]",inputs:["control"]};var j=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.onInit=function(){this.label=this.label||"label"},e}(I);j.meta={selector:"[control-checkbox]",inputs:["control","label"],template:'\n\t\t<div class="group--checkbox" [class]="{ required: control.validators.length }">\n\t\t\t<input type="checkbox" class="control" [id]="control.name" [formControl]="control" [value]="true" />\n\t\t\t<label [labelFor]="control.name">\n\t\t\t\t<svg class="icon icon--checkbox"><use xlink:href="#checkbox"></use></svg>\n\t\t\t\t<svg class="icon icon--checkbox-checked"><use xlink:href="#checkbox-checked"></use></svg>\n\t\t\t\t<span [innerHTML]="label | html"></span>\n\t\t\t</label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var R=function(){function t(){}return t.keydown$=function(){return this.keydown$_||(this.keydown$_=r.fromEvent(window,"keydown").pipe(n.shareReplay(1))),this.keydown$_},t.keyup$=function(){return this.keyup$_||(this.keyup$_=r.fromEvent(window,"keyup").pipe(n.shareReplay(1))),this.keyup$_},t.keys$=function(){var t=this;return this.keys$_||(this.keys$_=r.merge(this.keydown$(),this.keyup$()).pipe(n.map((function(e){var n=t.keys;return"keydown"===e.type?n[e.key]=!0:delete n[e.key],t.keys})),n.startWith(this.keys),n.shareReplay(1))),this.keys$_},t.key$=function(){if(!this.key$_){var t=/\w/;this.key$_=this.keydown$().pipe(n.filter((function(e){return e.key&&e.key.match(t)})),n.map((function(t){return t.key})),n.shareReplay(1))}return this.key$_},t.typing$=function(){if(!this.typing$_){var t,e="";this.typing$_=this.key$().pipe(n.map((function(n){return t&&clearTimeout(t),e+=n,t=setTimeout((function(){e=""}),1500),e})),n.shareReplay(1))}return this.typing$_},t}();s(R,"keys",{});var F=function(e){function r(){return e.apply(this,arguments)||this}a(r,e);var o=r.prototype;return o.onInit=function(){var t=this;this.label=this.label||"label",this.dropped=!1,this.dropdownId=u.nextId(),R.typing$().pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.scrollToWord(e)}))},o.scrollToWord=function(e){for(var n=this.control.options||[],r=-1,o=0;o<n.length;o++){if(0===n[o].name.toLowerCase().indexOf(e.toLowerCase())){r=o;break}}if(-1!==r){var i=t.getContext(this).node,s=i.querySelector(".dropdown"),a=i.querySelector(".nav--dropdown").children[r];s.scrollTo(0,a.offsetTop)}},o.setOption=function(t){var e;if(this.isMultiple){var n=this.control.value||[],r=n.indexOf(t.id);-1!==r?n.splice(r,1):n.push(t.id),function(t){throw new Error('"'+t+'" is read-only')}("value"),n=n.length?n.slice():null}else e=t.id;this.control.value=e,this.change.next(e)},o.hasOption=function(t){return this.isMultiple?-1!==(this.control.value||[]).indexOf(t.id):this.control.value===t.id},o.getLabel=function(){var t=this.control.value,e=this.control.options||[];if(this.isMultiple)return(t=t||[]).length?t.map((function(t){var n=e.find((function(e){return e.id===t||e.name===t}));return n?n.name:""})).join(", "):this.select||"select";var n=t?e.find((function(e){return e.id===t||e.name===t})):null;return n?n.name:this.select||"select"},o.onDropped=function(t){this.dropped&&null===t&&(this.control.touched=!0),this.dropped=t===this.dropdownId},i(r,[{key:"isMultiple",get:function(){return this.multiple&&!1!==this.multiple&&"false"!==this.multiple}}]),r}(I);F.meta={selector:"[control-custom-select]",outputs:["change"],inputs:["control","label","multiple","select"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length, multiple: isMultiple }" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<div class="group--control-select">\n\t\t\t\t<span class="control--custom-select" [innerHTML]="getLabel() | label"></span>\n\t\t\t\t<svg class="caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t<div class="category" [innerHTML]="label"></div>\n\t\t\t<ul class="nav--dropdown" [class]="{ multiple: isMultiple }">\n\t\t\t\t<li (click)="setOption(item)" [class]="{ empty: item.id == null }" *for="let item of control.options">\n\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name | label"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t'};var O=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.onInit=function(){this.label=this.label||"label",this.labels=window.labels||{},this.file=null,this.onReaderComplete=this.onReaderComplete.bind(this)},n.onInputDidChange=function(t){var e=t.target.files[0];this.file={name:e.name,lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,size:e.size,type:e.type};var n=new FileReader;n.addEventListener("load",this.onReaderComplete),n.readAsDataURL(e)},n.onReaderComplete=function(t){var e=t.target.result;this.file.content=e,this.control.value=this.file},e}(I);O.meta={selector:"[control-file]",inputs:["control","label"],template:'\n\t\t<div class="group--control group--control--file" [class]="{ required: control.validators.length }">\n\t\t\t<input name="file" type="file" id="picture" accept=".jpg,.jpgeg,.png,.tiff" class="control--file" (change)="onInputDidChange($event)" />\n\t\t\t<div class="control" [innerHTML]="file?.name || (\'select_file\' | label)"></div>\n\t\t\t<button type="button" class="btn btn--file" [innerHTML]="\'upload\' | label"></button>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var V=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.onInit=function(){this.label=this.label||"label",this.disabled=this.disabled||!1},e}(I);V.meta={selector:"[control-text]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--control" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<input type="text" class="control" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var P=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.getLabel=function(t,e){return S.transform("error_"+t)},e}(I);P.meta={selector:"errors-component",inputs:["control"],template:'\n\t<div class="inner" [style]="{ display: control.invalid && control.touched ? \'block\' : \'none\' }">\n\t\t<div class="error" *for="let [key, value] of control.errors">\n\t\t\t<span [innerHTML]="getLabel(key, value)"></span>\n\t\t\t\x3c!-- <span class="key" [innerHTML]="key"></span> <span class="value" [innerHTML]="value | json"></span> --\x3e\n\t\t</div>\n\t</div>\n\t'};var H=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.onTest=function(t){this.test.next(t)},n.onReset=function(t){this.reset.next(t)},e}(t.Component);H.meta={selector:"test-component",inputs:["form"],outputs:["test","reset"],template:'\n\t<div class="test-component" *if="!(\'production\' | flag)">\n\t\t<div class="test-component__title">development mode</div>\n\t\t<code [innerHTML]="form.value | json"></code>\n\t\t<button type="button" class="btn--submit" (click)="onTest($event)"><span>test</span></button>\n\t\t<button type="button" class="btn--submit" (click)="onReset($event)"><span>reset</span></button>\n\t</div>\n\t'};var N=[j,F,O,V,P,H],U=[],z=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e}(t.Module);z.meta={imports:[],declarations:[].concat(N,U),exports:[].concat(N,U)};var Y=function(){function t(){}return t.http$=function(t,e,o,i,s){var a=this;void 0===s&&(s=null);var l=null,c={method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:-1!==["POST","PUT","PATCH"].indexOf(t)?JSON.stringify(o):void 0};return s&&(c.credentials="include",s=window.btoa(s),c.headers.Authorization="Basic "+s),c.headers=new Headers(c.headers),r.from(fetch(e,c).then((function(t){l=t;try{var e,n=t.headers.get("content-type");return e=n&&-1!==n.indexOf("application/json")?t.json():t.text(),t.ok?e:e.then((function(t){return Promise.reject(t)}))}catch(e){return t.ok?(console.warn("HttpService.http$","Cannot parse response"),Promise.resolve()):Promise.reject(e)}}))).pipe(n.catchError((function(t){return r.throwError(a.getError(t,l))})))},t.get$=function(t,e,n){var r=this.query(e);return this.http$("GET",""+t+r,void 0,n)},t.delete$=function(t){return this.http$("DELETE",t)},t.post$=function(t,e){return this.http$("POST",t,e)},t.put$=function(t,e){return this.http$("PUT",t,e)},t.patch$=function(t,e){return this.http$("PATCH",t,e)},t.query=function(t){return""},t.getError=function(t,e){var n="object"==typeof t?t:{};return n.status||(n.status=e?e.status:0),n.statusCode||(n.statusCode=e?e.status:0),n.statusMessage||(n.statusMessage=e?e.statusText:t),n},t}(),G=new RegExp(/^(\d{1,2})[\/|\-|\s](\d{1,2})[\/|\-|\s](\d{4})$/);var K=new RegExp(/^(\d{1,2})[\/|\-|\s](\d{1,2})[\/|\-|\s](\d{4})$/);function B(){return new e.FormValidator((function(t){if(!t)return null;if(t instanceof Date)return null;var e=K.exec(t);return e&&function(t,e){try{return NaN!==Date.parse(t)}catch(t){try{return NaN!==Date.parse(e[2]+"/"+e[1]+"/"+e[3])}catch(t){return!1}}}(t,e)?null:{birthDate:{valid:!1}}}))}var W=function(){function t(){}return t.toSelectOptions=function(t){return(t=t.slice().map((function(t){return{id:t.value,name:t.label}}))).unshift({id:null,name:"select"}),t},t}(),J=new RegExp(/^(\d{1,2})[\/|\-|\s](\d{1,2})[\/|\-|\s](\d{4})$/),Q=function(r){function o(){return r.apply(this,arguments)||this}a(o,r);var s=o.prototype;return s.onInit=function(){var r=this,o=t.getContext(this).node;this.node=o,this.currentStep=0,this.onNext=this.onNext.bind(this),this.onPrev=this.onPrev.bind(this),(this.nexts=Array.prototype.slice.call(o.querySelectorAll(".btn--next"))).forEach((function(t){t.addEventListener("click",r.onNext)})),(this.prevs=Array.prototype.slice.call(o.querySelectorAll(".btn--prev"))).forEach((function(t){t.addEventListener("click",r.onPrev)})),this.error=null,this.success=!1;var i,s=this.form=new e.FormGroup({step0:new e.FormGroup({picture:new e.FormControl(null,[e.Validators.RequiredValidator()])}),step1:new e.FormGroup({firstName:new e.FormControl(null,[e.Validators.RequiredValidator()]),lastName:new e.FormControl(null,[e.Validators.RequiredValidator()]),birthDate:new e.FormControl(null,[e.Validators.RequiredValidator(),B(),(i=14,new e.FormValidator((function(t){if(!t)return null;var e;if(t instanceof Date)e=t;else{var n=G.exec(t);if(!n)return null;e=new Date(n[2]+"/"+n[1]+"/"+n[3])}var r=new Date;return r.getFullYear()-e.getFullYear()>i||r.getFullYear()-e.getFullYear()==i&&r.getMonth()-e.getMonth()>0||r.getFullYear()-e.getFullYear()==i&&r.getMonth()-e.getMonth()==0&&r.getDate()-e.getDate()>=0?null:{age:i}})))]),telephone:new e.FormControl(null,[e.Validators.RequiredValidator()]),email:new e.FormControl(null,[e.Validators.RequiredValidator(),e.Validators.EmailValidator()]),address:new e.FormControl(null,[e.Validators.RequiredValidator()]),userName:new e.FormControl(null,[e.Validators.RequiredValidator()]),category:new e.FormControl(null,[e.Validators.RequiredValidator()])}),step2:new e.FormGroup({parentFirstName:new e.FormControl(null,[e.Validators.RequiredValidator()]),parentLastName:new e.FormControl(null,[e.Validators.RequiredValidator()]),parentIdCard:new e.FormControl(null,[e.Validators.RequiredValidator()]),parentTelephone:new e.FormControl(null,[e.Validators.RequiredValidator()]),parentEmail:new e.FormControl(null,[e.Validators.RequiredValidator(),e.Validators.EmailValidator()])}),step3:new e.FormGroup({rulesChecked:new e.FormControl(null,[e.Validators.RequiredValidator()]),privacyChecked:new e.FormControl(null,[e.Validators.RequiredValidator()])}),checkRequest:window.antiforgery,checkField:""});(this.controls=s.controls).step1.controls.category.options=W.toSelectOptions(window.category.options),s.changes$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){r.pushChanges()}))},s.onNext=function(t){var e=this.controls["step"+this.currentStep];e.valid?(console.log("onNext",this.currentStep,this.form),1===this.currentStep&&this.isOfAge?this.currentStep=3:1!==this.currentStep||this.isOfAge?this.currentStep<3&&this.currentStep++:this.currentStep=2,(e=this.controls["step"+this.currentStep]).touched=!1,this.pushChanges()):Object.keys(e.controls).forEach((function(t){e.controls[t].touched=!0}))},s.onPrev=function(){this.currentStep>0&&this.currentStep--,this.pushChanges()},s.onSubmit=function(t){var e=this,r=this.form;console.log("UrbanFormComponent.onSubmit",r.value),r.valid?(r.submitted=!0,Y.post$("/api/url",r.value).pipe(n.first()).subscribe((function(t){e.success=!0}),(function(t){console.log("UrbanFormComponent.error",t),e.error=t,e.pushChanges()}))):r.touched=!0},i(o,[{key:"isOfAge",get:function(){var t=this.form.controls.step1.controls.birthDate.value;if(t){var e=J.exec(t);if(e){var n=new Date(e[2]+"/"+e[1]+"/"+e[3]),r=new Date;return r.getFullYear()-n.getFullYear()>18||r.getFullYear()-n.getFullYear()==18&&r.getMonth()-n.getMonth()>0||r.getFullYear()-n.getFullYear()==18&&r.getMonth()-n.getMonth()==0&&r.getDate()-n.getDate()>=0}return!1}return!1}}]),o}(t.Component);Q.meta={selector:"[urban-form]"};var X=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e}(t.Module);X.meta={imports:[t.CoreModule,e.FormModule,q,z],declarations:[Q],bootstrap:l};var Z=function(){function t(t){this.node=t,this.currentStep=0,this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll),this.onScroll()}var e=t.prototype;return e.destroy=function(){window.removeEventListener("scroll",this.onScroll)},e.onScroll=function(){var t=window.innerHeight,e=this.node,n=e.getBoundingClientRect();Math.max(0,Math.min(1,1-(n.top-t/2)/(t/2)))>0?e.classList.add("enter"):e.classList.remove("enter")},t.init=function(){return this.items=Array.prototype.slice.call(document.querySelectorAll("[urban-enter]")).map((function(e){return new t(e)}))},t.destroy=function(){return this.items.forEach((function(t){return t.destroy()}))},t}();s(Z,"items",[]);var tt=function(){function t(t){this.node=t,this.onClick=this.onClick.bind(this),t.addEventListener("click",this.onClick)}var e=t.prototype;return e.destroy=function(){this.node.removeEventListener("click",this.onClick)},e.onClick=function(){var t=this.node,e=t.querySelector("video");e.paused?(e.play(),t.classList.add("playing")):(e.pause(),t.classList.remove("playing"))},t.init=function(){return this.items=Array.prototype.slice.call(document.querySelectorAll("[urban-video]")).map((function(e){return new t(e)}))},t.destroy=function(){return this.items.forEach((function(t){return t.destroy()}))},t}();s(tt,"items",[]),document.addEventListener("DOMContentLoaded",(function(){Z.init(),tt.init()})),t.Browser.bootstrap(X)}));
//# sourceMappingURL=main.min.js.map